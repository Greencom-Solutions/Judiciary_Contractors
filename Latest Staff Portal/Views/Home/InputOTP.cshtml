

<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from dreamguys.co.in/demo/doccure/admin/login.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 30 Nov 2019 04:12:46 GMT -->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
    <title>ESS - Login</title>

    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="~/assets/img/logo.png">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/assets/css/bootstrap.min.css">

    <!-- Fontawesome CSS -->
    <link rel="stylesheet" href="/assets/css/font-awesome.min.css">

    <!-- Main CSS -->
    <link rel="stylesheet" href="/assets/css/style.css">

    <script src="~/assets/js/jquery2.0.3.min.js"></script>


    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/custom.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/assets/css/custom.css">

    <script src="~/assets/js/jquery2.0.3.min.js"></script>

    <style>
        :root {
            --primary: #30473d;
            --primary-hover: #c8af38;
            --primary-light: #e8f0fe;
            --error: #d93025;
            --surface: #fff;
            --on-surface: #202124;
            --on-surface-variant: #5f6368;
            --outline: #dadce0;
            --radius: 8px;
        }

        body {
            background-color: #f8f9fa !important;
            font-family: 'Montserrat', sans-serif;
        }

        .card-container {
            max-width: 450px;
            width: 100%;
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: 0 1px 2px 0 rgba(60,64,67,.3), 0 2px 6px 2px rgba(60,64,67,.15);
            overflow: hidden;
            margin: 40px auto 80px;
        }

        .card-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid var(--outline);
            background-color: #f5f8fc;
            text-align: center;
        }

        .logo-container {
            padding: 10px 0;
        }

            .logo-container img {
                max-width: 80px;
                margin-bottom: 10px;
            }

        .card-title {
            color: var(--primary);
            font-size: 22px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .card-subtitle {
            font-size: 14px;
            color: var(--on-surface-variant);
            margin-bottom: 15px;
            font-weight: 400;
        }

        .card-body {
            padding: 24px 32px;
        }

        .otp-input-group {
            display: flex;
            justify-content: center;
            margin: 24px auto;
            max-width: 360px;
            gap: 8px;
        }

        .otp-input {
            width: 50px;
            height: 60px;
            text-align: center;
            font-size: 24px;
            font-weight: 500;
            border: 2px solid var(--outline);
            border-radius: var(--radius);
            background-color: #f9f9f9;
            transition: all 0.3s ease;
        }

            .otp-input:focus {
                border-color: var(--primary);
                background-color: #fff;
                box-shadow: 0 0 0 2px rgba(48, 71, 61, 0.1);
                outline: none;
            }

        .otp-instructions {
            text-align: center;
            margin-bottom: 20px;
            color: var(--on-surface);
            font-size: 16px;
            font-weight: 500;
        }

        .btn {
            height: 48px;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 500;
            letter-spacing: 0.25px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            margin-bottom: 16px;
        }

        .btn-primary {
            background-color: var(--primary);
            border-color: var(--primary);
            color: white;
        }

            .btn-primary:hover, .btn-primary:focus {
                background-color: var(--primary-hover);
                border-color: var(--primary-hover);
                box-shadow: 0 1px 2px 0 rgba(60,64,67,.3);
            }

        .btn-secondary {
            color: var(--primary);
            border-color: var(--primary);
            background-color: transparent;
        }

            .btn-secondary:hover, .btn-secondary:focus {
                background-color: rgba(48, 71, 61, 0.05);
                color: var(--primary-hover);
                border-color: var(--primary-hover);
            }

        #countdownTimer {
            font-size: 18px;
            font-weight: 500;
            color: var(--primary);
            margin: 16px 0;
            text-align: center;
        }

        .alert-danger {
            background-color: rgba(217, 48, 37, 0.1);
            border-color: rgba(217, 48, 37, 0.2);
            color: var(--error);
            border-radius: 4px;
            padding: 12px 16px;
            font-size: 14px;
            margin-bottom: 24px;
        }

        @@media (max-width: 480px) {
            .card-body {
                padding: 20px 20px 24px;
            }

            .card-container {
                margin: 20px 15px 60px;
                max-width: 100%;
            }

            .otp-input-group {
                gap: 6px;
            }

            .otp-input {
                width: 45px;
                height: 55px;
                font-size: 22px;
            }
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


</head>
<body id="body">
    <link href="~/assets/css/Loader.css" rel="stylesheet" />
    <div class="loading" align="center" id="divLoader">
        <div class="loader-container">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
    </div>

    <script src="~/assets/js/ObfuscateSite.js"></script>
    <!-- Main Wrapper -->
    <div class="main-wrapper login-body mt-2">
        <div class="login-wrapper">
            <div class="container">
                <div class="container d-flex justify-content-center align-items-center" style="height: 70vh; ">
                    <div class="card" style="width: 100%; max-width: 600px;">
                        @if (TempData["error"] != null)
                        {

                            <div class="alert alert-danger" id="alert-danger" role="alert">
                                @TempData["error"]
                            </div>

                        }

                        <div class="card-header">

                            <center class="mt-2">
                                <img class="img-fluid" src="/assets2/img/logo-dark.png" alt="Logo" style="height: 40px;">
                                <div class="mt-3">
                                    <h2>Verification Required</h2>
                                    <p>Enter the 6-digit code sent to your email</p>
                                </div>

                            </center>
                        </div>
                        <div class="card-body">
                            @* <p class="otp-instructions">Enter your one-time password:</p>*@

                            <div class="otp-input-group">
                                <input type="text" class="otp-input" maxlength="1" id="otp1" oninput="moveToNext(this, 'otp2')" />
                                <input type="text" class="otp-input" maxlength="1" id="otp2" oninput="moveToNext(this, 'otp3')" />
                                <input type="text" class="otp-input" maxlength="1" id="otp3" oninput="moveToNext(this, 'otp4')" />
                                <input type="text" class="otp-input" maxlength="1" id="otp4" oninput="moveToNext(this, 'otp5')" />
                                <input type="text" class="otp-input" maxlength="1" id="otp5" oninput="moveToNext(this, 'otp6')" />
                                <input type="text" class="otp-input" maxlength="1" id="otp6" oninput="moveToNext(this, null)" />
                            </div>

                            <div id="countdownTimer" class="countdown-timer text-danger">03:00</div>

                            <div class="action-buttons">
                                <button id="confirmBtn" class="btn btn-primary btn-block" type="button" onclick="confirmOTP()">
                                    <i class="fa fa-check-circle mr-2"></i> Verify Code
                                </button>
                                <button id="resendBtn" class="btn btn-secondary btn-block" type="button" onclick="resendOTP()" style="display: none;">
                                    <i class="fa fa-refresh mr-2"></i>
                                    Resend Code
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- /Main Wrapper -->
    <!-- jQuery -->
    <!-- Bootstrap Core JS -->
    <script src="/assets/js/popper.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>

    <!-- Custom JS -->
    <script src="/assets/js/script.js"></script>
    <script src="~/assets/js/ShowProgression.js"></script>

    @*<script src="~/SiteJS/LoginJS.js"></script>*@
</body>

</html>

<script>
    document.addEventListener('DOMContentLoaded', (event) => {
        const passwordField = document.getElementById('userpassword');
        passwordField.addEventListener('paste', (e) => {
            e.preventDefault();
            alert('Pasting is disabled for this field.');
        });
    });
    function LoginUser() {
        var username = $("#username").val();
        var password = $("#userpassword").val();

        if (username === "") {
            Swal.fire('Warning', 'Enter Username', 'warning');
            return;
        } else if (password === "") {
            Swal.fire('Warning', 'Enter Your Password', 'warning');
            return;
        }

        ShowProgress();

        $.ajax({
            type: "POST",
            url: "/Home/LoginUser",
            contentType: "application/json; charset=utf-8",
            data: JSON.stringify({ UserName: username, Password: password }),
            dataType: "json",
            success: function (data) {
                //alert(data.message);

                if (data.success) {
                    window.location = data.message; // Redirect to the given URL
                } else {
                    Swal.fire('Error', data.message, 'error'); // Display error message
                    HideProgress();
                }
            },
            error: function (err) {
                HideProgress(); // Hide loading indicator

                // Handle server-side or network errors
                Swal.fire('Error', 'An unexpected error occurred: ' + err.responseText, 'error');
            }
        });
    }

</script>

<script>
    function moveToNext(current, nextFieldID) {
        if (current.value.length >= 1 && nextFieldID) {
            document.getElementById(nextFieldID).focus();
        }
    }

    // Gather OTP from the input boxes
    function getOTP() {
        var otp = '';
        for (var i = 1; i <= 6; i++) {
            otp += document.getElementById('otp' + i).value;
        }
        return otp;
    }

    function limitInputLength(element, maxLength) {
        if (element.value.length > maxLength) {
            element.value = element.value.slice(0, maxLength);
        }
    }

    // Start the countdown timer
    function startCountdown(duration, display) {
        var timer = duration, minutes, seconds;
        var interval = setInterval(function () {
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;

            if (--timer < 0) {
                clearInterval(interval);
                display.textContent = "Code expired";
                display.style.color = "#d93025";
                document.getElementById('confirmBtn').style.display = 'none';
                document.getElementById('resendBtn').style.display = 'flex';
            }
        }, 1000);
    }

    function resendOTP() {
        $.ajax({
            url: '/Home/ResentOTP',
            type: 'POST'
        }).done(function (response) {
            switch (response) {
                case "true":
                    document.getElementById('resendBtn').style.display = 'none';
                    document.getElementById('confirmBtn').style.display = 'flex';
                    var display = document.querySelector('#countdownTimer');
                    display.style.color = "#30473d";
                    startCountdown(3 * 60, display); // Restart the countdown

                    // Clear OTP fields
                    for (var i = 1; i <= 6; i++) {
                        document.getElementById('otp' + i).value = "";
                    }
                    document.getElementById('otp1').focus();

                    Swal.fire({
                        title: "Code Sent",
                        text: "A new verification code has been sent to your email",
                        icon: "success",
                        confirmButtonColor: '#30473d'
                    });
                    break;
                default:
                    Swal.fire({
                        title: "Error",
                        text: "Failed to send verification code. Please try again.",
                        icon: "error",
                        confirmButtonColor: '#30473d'
                    });
            }
        });
    }

    // Initialize the countdown timer on page load
    window.onload = function () {
        var countdownDuration = 3 * 60; // 3 minutes in seconds
        var display = document.querySelector('#countdownTimer');
        startCountdown(countdownDuration, display);

        // Add keyboard navigation for OTP inputs
        const otpInputs = document.querySelectorAll('.otp-input');
        otpInputs.forEach((input, index) => {
            input.addEventListener('keydown', function (e) {
                if (e.key === 'Backspace' && !this.value && index > 0) {
                    otpInputs[index - 1].focus();
                }
            });

            // Allow only numbers
            input.addEventListener('input', function () {
                this.value = this.value.replace(/[^0-9]/g, '');
            });
        });
    };

    function confirmOTP() {
        var data = {
            OTP: getOTP()
        };
        if (data.OTP.length !== 6) {
            Swal.fire("Warning","Invalid Code","warning");
        }
        else {
            ShowProgress();
            $.ajax({
                type: "POST",
                url: "/Home/ConfirmOTP",
                data: JSON.stringify(data),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (data) {
                    HideProgress();
                    if (data.success) {
                        Swal.fire('Success', 'Login successful.', 'success');
                        window.location.href = (data.message);
                    } else {
                        Swal.fire("Warning",data.message,"warning" );
                    }
                },
                error: function (err) {
                    HideProgress();
                    Swal.fire('Error', 'An error occurred while submitting the request.', 'error');
                }
            });
        }
    }

</script>